# 学习笔记

## 分号问题

语言的语句分割是个经典的问题。设计者需要让语言使用者明确区分出：

1. 因为一行太长而想用换行分割语句。
1. 确实想写两条语句。

Lisp 并不存在这样的问题，因为 Lisp 通常每条语句都用括号包裹起来，无论如何换行都不会妨碍语句分割。这样做的代价就是放弃了中缀语法，包括中缀的符号运算和中缀赋值（绑定）。相比 `(+ (* 12 1) 9)`，`(12 * 1) + 9` 少了一组括号：因为我们明确知道中缀加法需要两个操作数。甚至熟悉优先级规则的话，还能再减少一组括号，变成 `12*1+9`。还有，`(define alpha beta)` 和 `(set! alpha beta)` 具有一样的问题，这种明知是两个“操作数”的情况中缀情况更清爽。当然这都是 S 表达式必然要付出的代价，只能看作特性，不能看作缺陷。

Haskell 和 Ruby 允许函数调用不写括号，无疑是另一个极端了。这样的语法中语句分割是个很大的问题：

    func alpha
         beta

这到底是 `func(alpha)` 和 `beta` 还是 `func(alpha, beta)` 呢？语言设计里一定要解决这个问题。一般的方式是赋予缩进语法意义：例如说当 `beta` 缩进跟 `func` 对齐，那它就是另一条语句；不然就是上一条语句的延续。或者还有其他的思路。但无论如何赋予空白语法意义都是值得亮黄灯警告的事情，一定要值得这样做才能这样做。

剩下的语言大多都是 `func(alpha, beta)` 格式调用函数的语言，同时又支持中缀语法。

古老的 C 语言的思路很单纯，语句后面加一个分号。不加分号就是同一条语句。C 无疑是一种要解决极为需要控制力的问题的语言，这种情况下一个分号的噪音对程序员来说不是什么过多的负担。简单粗暴的解决语句分割，大家都很满意。后来的追随者 C++ 有了更现代的开发设施，但是语言规则变得极为复杂，所以也很少有人抱怨分号问题。但 Java 既没有偏执的控制力，也不那么庞杂恐怖，却要程序员每行写个分号，就不那么让人开心了。

Rust 采取的是 `{ a; b; c }` 格式的语法。分号不是每个语句的结尾，而是语句之间的分割，这样设计的语言多半需要“面向表达式”，也就是全部的语法单元都有一个类型。虽然并不是有类型就需要有值，但 Rust 还是给了一个值。它造成了一些困扰，但是因为设施十分健全，所以并没有怨声载道。程序员用分号的代价换取了不用写 `return`，还是一笔不错的交易。

相比而言 Perl 就比 Java 还“恶劣”，分号好比额外的税赋。但 Perl 本身就设计成坐镇在语法阵线前言，它的决定很难用体验来说明好坏。

在此之外就是没有分号，或者可以没有分号的领域了。

Golang 的思路是完全的工程思路，不需要分号的时候，混淆就发生在那些中缀代码上。编译器通过给出警告甚至是错误拒绝那些有可能有歧义的代码就好了。这个思路也是一记直球：简单而有效。但当然只能出现在有编译工具，或者固定的不容置疑的规范时才能出现。

Python 本身就设计成空白有其语义，所以使用之前提到的思路解决语句分割反而会更复杂，但问题本身已经有了，只要接收它，大家就可以开心和幸福。Python 看起来总是这么孤高：自称优雅，自有哲学。那些拿着直尺写 Python 代码的人是不能理解 Python 教徒的。

最后就到了 Javascript，它是有无相生，阴阳交泰的语言。它十分像真实的世界：你要为自己的每个选择付出代价。选择不加分号的人，要自己承担语句歧义造成的问题，无论是使用别的什么工具，还是凭借精神力量，都是自己要承担的后果。如果不想承担这些，那么就不能在分号键磨损之后抱怨 Javascript 不好。

Javascript 广泛的得到了“自由和灵活”的评价，但这也跟现实世界一样：只有自律才能获得自由。
